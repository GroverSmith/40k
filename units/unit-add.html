<!-- filename: units/unit-add.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Unit - 40k Crusade Campaign Tracker</title>
    <meta name="description" content="Add a new unit or character to your Crusade force.">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="../css/variables.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/buttons-unified.css">
    <link rel="stylesheet" href="../css/components-unified.css">
    <link rel="stylesheet" href="../css/responsive.css">
    <link rel="stylesheet" href="../css/forms-unified.css">
    <link rel="stylesheet" href="../css/modal.css">
    <link rel="stylesheet" href="../css/user-dropdown.css">
    <link rel="stylesheet" href="../css/user-field.css">
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-button">← Back to Campaign Tracker</a>
        
        <header>
            <h1>Add Unit or Character</h1>
            <p>Add a new unit or character to your Crusade force roster.</p>
        </header>
        
        <main>
            <form id="add-unit-form" class="crusade-form">
                <!-- Basic Information -->
                <fieldset>
                    <legend>Basic Information</legend>
                    
                    <div class="form-group">
                        <label for="user-name">User Name</label>
                        <input type="text" id="user-name" name="userName" required readonly>
                        <small class="help-text">Auto-populated from selected user</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="force-name">Force Name</label>
                        <input type="text" id="force-name" name="forceName" required readonly>
                        <small class="help-text">Auto-populated from force context</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="unit-name">Unit/Character Name <span class="required">*</span></label>
                        <input type="text" id="unit-name" name="name" required 
                               placeholder="e.g., Captain Aurelius, Squad Alpha, Predator 'Iron Fist'">
                        <small class="help-text">Give your unit a unique name for identification</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="data-sheet">Data Sheet <span class="required">*</span></label>
                        <input type="text" id="data-sheet" name="dataSheet" required 
                               placeholder="e.g., Space Marine Captain, Intercessor Squad, Predator Destructor">
                        <small class="help-text">The official unit name from the codex</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="unit-type">Unit Type <span class="required">*</span></label>
                        <select id="unit-type" name="type" required>
                            <option value="">-- Select Type --</option>
                            <option value="Character">Character</option>
                            <option value="Battleline">Battleline</option>
                            <option value="Infantry Squad">Infantry Squad</option>
                            <option value="Vehicle">Vehicle</option>
                            <option value="Monster">Monster</option>
                            <option value="Walker">Walker</option>
                            <option value="Mounted">Mounted</option>
                            <option value="Fortification">Fortification</option>
                            <option value="Dedicated Transport">Dedicated Transport</option>
                            <option value="Flyer">Flyer</option>
                            <option value="Titanic">Titanic</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </fieldset>
                
                <!-- Points and Version -->
                <fieldset>
                    <legend>Points and Version</legend>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="points">Points Value</label>
                            <input type="number" id="points" name="points" min="0" max="9999" 
                                   placeholder="e.g., 85">
                            <small class="help-text">Base points cost</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="crusade-points">Crusade Points</label>
                            <input type="number" id="crusade-points" name="crusadePoints" min="0" max="999" 
                                   placeholder="e.g., 5" value="0">
                            <small class="help-text">Power Level for Crusade</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="mfm-version">MFM Version</label>
                            <input list="mfm-versions" id="mfm-version" name="mfmVersion" 
                                   placeholder="e.g., 2025.08 or enter custom">
                            <datalist id="mfm-versions">
                                <option value="2025.08">August 2025 (Current)</option>
                                <option value="2025.06">June 2025</option>
                                <option value="2025.01">January 2025</option>
                                <option value="2024.10">October 2024</option>
                                <option value="2024.09">September 2024</option>
                                <option value="2024.06">June 2024</option>
                                <option value="2024.04">April 2024</option>
                                <option value="2024.01">January 2024</option>
                                <option value="2023.06">June 2023 (10th Edition Launch)</option>
                            </datalist>
                            <small class="help-text">Select from list or type custom version</small>
                        </div>
                    </div>
                </fieldset>
                
                <!-- Wargear and Upgrades -->
                <fieldset>
                    <legend>Wargear and Upgrades</legend>
                    
                    <div class="form-group">
                        <label for="wargear">Wargear</label>
                        <textarea id="wargear" name="wargear" rows="2" 
                                  placeholder="e.g., Bolt rifle, Frag grenades, Krak grenades"></textarea>
                        <small class="help-text">List all wargear (comma-separated)</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="enhancements">Enhancements</label>
                        <textarea id="enhancements" name="enhancements" rows="2" 
                                  placeholder="e.g., Master of the Vanguard, Artificer Armour"></textarea>
                        <small class="help-text">List any enhancements (comma-separated)</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="relics">Crusade Relics</label>
                        <textarea id="relics" name="relics" rows="2" 
                                  placeholder="e.g., Blade of the Worthy, Storm Shield of Heroes"></textarea>
                        <small class="help-text">List any Crusade relics (comma-separated)</small>
                    </div>
                </fieldset>
                
                <!-- Battle Experience -->
                <fieldset>
                    <legend>Battle Experience</legend>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="xp">Experience Points (XP)</label>
                            <input type="number" id="xp" name="xp" min="0" max="999" value="0">
                            <small class="help-text">Total XP earned</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="rank">Rank</label>
                            <select id="rank" name="rank">
                                <option value="">-- Auto-calculated --</option>
                                <option value="Battle-ready">Battle-ready (0-5 XP)</option>
                                <option value="Blooded">Blooded (6-15 XP)</option>
                                <option value="Veteran">Veteran (16-30 XP)</option>
                                <option value="Heroic">Heroic (31-50 XP)</option>
                                <option value="Legendary">Legendary (51+ XP)</option>
                            </select>
                            <small class="help-text">Leave blank to auto-calculate from XP</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="battle-count">Battles Fought</label>
                            <input type="number" id="battle-count" name="battleCount" min="0" max="999" value="0">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="kill-count">Kill Count</label>
                            <input type="number" id="kill-count" name="killCount" min="0" max="9999" value="0">
                            <small class="help-text">Total enemy units destroyed</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="times-killed">Times Killed</label>
                            <input type="number" id="times-killed" name="timesKilled" min="0" max="999" value="0">
                            <small class="help-text">Times destroyed in battle</small>
                        </div>
                    </div>
                </fieldset>
                
                <!-- Battle Honors and Scars -->
                <fieldset>
                    <legend>Battle Honors and Scars</legend>
                    
                    <div class="form-group">
                        <label for="battle-traits">Battle Traits</label>
                        <textarea id="battle-traits" name="battleTraits" rows="2" 
                                  placeholder="e.g., Swift Strike, Marksman's Honour"></textarea>
                        <small class="help-text">List battle traits earned (comma-separated)</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="battle-scars">Battle Scars</label>
                        <textarea id="battle-scars" name="battleScars" rows="2" 
                                  placeholder="e.g., Mark of Shame, Deep Scars"></textarea>
                        <small class="help-text">List battle scars suffered (comma-separated)</small>
                    </div>
                </fieldset>
                
                <!-- Narrative Information -->
                <fieldset>
                    <legend>Narrative Information</legend>
                    
                    <div class="form-group">
                        <label for="description">Unit Description</label>
                        <textarea id="description" name="description" rows="3" 
                                  placeholder="Describe the unit's appearance, personality, or combat style..."></textarea>
                        <small class="help-text">Describe your unit's character and appearance</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="notable-history">Notable History</label>
                        <textarea id="notable-history" name="notableHistory" rows="3" 
                                  placeholder="Record significant battles, heroic deeds, or memorable moments..."></textarea>
                        <small class="help-text">Record important events and achievements</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="notes">Additional Notes</label>
                        <textarea id="notes" name="notes" rows="2" 
                                  placeholder="Any other information..."></textarea>
                    </div>
                </fieldset>
                
                <!-- Hidden fields for keys -->
                <input type="hidden" id="user-key" name="userKey">
                <input type="hidden" id="force-key" name="forceKey">
                
                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="button" onclick="window.history.back()" class="btn-secondary">Cancel</button>
                    <button type="submit" id="submit-btn" class="btn-primary">
                        <span class="btn-text">Add Unit</span>
                        <span class="btn-loading" style="display: none;">
                            <div class="loading-spinner"></div>
                            Adding Unit...
                        </span>
                    </button>
                </div>
            </form>
            
            <!-- Success Message -->
            <div id="success-message" class="message success" style="display: none;">
                <h3>✅ Unit Added Successfully!</h3>
                <p>The unit has been added to your force roster.</p>
                <div class="message-actions">
                    <a href="../index.html" class="btn-secondary">Back to Home</a>
                    <button onclick="location.reload()" class="btn-primary">Add Another Unit</button>
                </div>
            </div>
            
            <!-- Error Message -->
            <div id="error-message" class="message error" style="display: none;">
                <h3>⚠ Error Adding Unit</h3>
                <p id="error-text">There was an error adding the unit. Please try again.</p>
            </div>
        </main>
    </div>

    <!-- JavaScript Files -->
    <!-- JavaScript Files -->
    <script src="../js/core/utils.js"></script>
    <script src="../js/core/config.js"></script>
    <script src="../js/core/cache-manager.js"></script>
    <script src="../js/core/key-utils.js"></script>

    <!-- NEW consolidated utilities -->
    <script src="../js/core/form-utilities.js"></script>
    <script src="../js/core/ui-helpers.js"></script>

    <!-- User modules -->
    <script src="../js/users/user-storage.js"></script>
    <script src="../js/users/user-api.js"></script>
    <script src="../js/users/user-ui.js"></script>
    <script src="../js/users/user-modal.js"></script>
    <script src="../js/users/user-manager.js"></script>

    <!-- Other dependencies -->

    <!-- Form modules -->
    <script src="../js/core/form-base.js"></script>
    <script src="unit-add.js"></script>
</body>
</html>