<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Separated MFM Data</title>
</head>
<body>
    <h1>Test Separated MFM Data</h1>
    <div id="results"></div>

    <!-- Load the separated data files -->
    <script src="../mfm/mfm-units-3_2.js"></script>
    <script src="../mfm/mfm-units-3_3.js"></script>
    <script src="../mfm/mfm-units-bundle.js"></script>
    
    <script src="../mfm/mfm-detachments-3_2.js"></script>
    <script src="../mfm/mfm-detachments-3_3.js"></script>
    <script src="../mfm/mfm-detachments-bundle.js"></script>

    <script>
        async function testSeparatedMFMData() {
            const results = document.getElementById('results');
            
            try {
                results.innerHTML += '<h2>Testing Units Data:</h2>';
                
                // Test units data
                if (window.MFM_UNITS_3_2) {
                    results.innerHTML += '<p>‚úÖ MFM Units 3.2 loaded successfully</p>';
                    results.innerHTML += `<p>üìä 3.2 has ${Object.keys(window.MFM_UNITS_3_2.factions).length} factions</p>`;
                    
                    // Test a specific faction
                    const spaceMarines = window.MFM_UNITS_3_2.factions['SPACE MARINES'];
                    if (spaceMarines) {
                        results.innerHTML += `<p>‚úÖ Space Marines faction found with ${Object.keys(spaceMarines.units).length} units</p>`;
                    }
                } else {
                    results.innerHTML += '<p>‚ùå MFM Units 3.2 not found</p>';
                }
                
                if (window.MFM_UNITS_3_3) {
                    results.innerHTML += '<p>‚úÖ MFM Units 3.3 loaded successfully</p>';
                    results.innerHTML += `<p>üìä 3.3 has ${Object.keys(window.MFM_UNITS_3_3.factions).length} factions</p>`;
                } else {
                    results.innerHTML += '<p>‚ùå MFM Units 3.3 not found</p>';
                }
                
                // Test units bundle
                if (window.MFM_UNITS_BUNDLE) {
                    results.innerHTML += '<p>‚úÖ MFM Units Bundle loaded successfully</p>';
                    
                    const versions = window.MFM_UNITS_BUNDLE.getAvailableVersions();
                    results.innerHTML += `<p>üìã Available units versions: ${versions.map(v => v.displayName).join(', ')}</p>`;
                    
                    // Test loading version 3.2
                    const units32 = await window.MFM_UNITS_BUNDLE.loadVersion('3.2');
                    results.innerHTML += `<p>‚úÖ Successfully loaded units version 3.2 (${units32.metadata.totalUnits} units)</p>`;
                }
                
                results.innerHTML += '<h2>Testing Detachments Data:</h2>';
                
                // Test detachments data
                if (window.MFM_DETACHMENTS_3_2) {
                    results.innerHTML += '<p>‚úÖ MFM Detachments 3.2 loaded successfully</p>';
                    results.innerHTML += `<p>üìä 3.2 has ${Object.keys(window.MFM_DETACHMENTS_3_2.factions).length} factions with detachments</p>`;
                    
                    // Test a specific faction's detachments
                    const spaceMarinesDet = window.MFM_DETACHMENTS_3_2.factions['SPACE MARINES'];
                    if (spaceMarinesDet && spaceMarinesDet.enhancements) {
                        const detachmentCount = Object.keys(spaceMarinesDet.enhancements).length;
                        results.innerHTML += `<p>‚úÖ Space Marines has ${detachmentCount} detachments</p>`;
                    }
                } else {
                    results.innerHTML += '<p>‚ùå MFM Detachments 3.2 not found</p>';
                }
                
                if (window.MFM_DETACHMENTS_3_3) {
                    results.innerHTML += '<p>‚úÖ MFM Detachments 3.3 loaded successfully</p>';
                    results.innerHTML += `<p>üìä 3.3 has ${Object.keys(window.MFM_DETACHMENTS_3_3.factions).length} factions with detachments</p>`;
                } else {
                    results.innerHTML += '<p>‚ùå MFM Detachments 3.3 not found</p>';
                }
                
                // Test detachments bundle
                if (window.MFM_DETACHMENTS_BUNDLE) {
                    results.innerHTML += '<p>‚úÖ MFM Detachments Bundle loaded successfully</p>';
                    
                    const versions = window.MFM_DETACHMENTS_BUNDLE.getAvailableVersions();
                    results.innerHTML += `<p>üìã Available detachments versions: ${versions.map(v => v.displayName).join(', ')}</p>`;
                    
                    // Test loading version 3.2
                    const detachments32 = await window.MFM_DETACHMENTS_BUNDLE.loadVersion('3.2');
                    results.innerHTML += `<p>‚úÖ Successfully loaded detachments version 3.2 (${detachments32.metadata.totalEnhancements} enhancements)</p>`;
                }
                
                results.innerHTML += '<h2>üéâ All tests passed! The separated data system is working correctly.</h2>';
                results.innerHTML += '<p><strong>Benefits:</strong></p>';
                results.innerHTML += '<ul>';
                results.innerHTML += '<li>‚úÖ Units data (228KB) - Only loaded by units module</li>';
                results.innerHTML += '<li>‚úÖ Detachments data (91KB) - Only loaded by force/army modules</li>';
                results.innerHTML += '<li>‚úÖ Better organization - All MFM files in mfm/ directory</li>';
                results.innerHTML += '<li>‚úÖ No CORS issues - Works on GitHub Pages</li>';
                results.innerHTML += '<li>‚úÖ Version selection - Easy to switch between versions</li>';
                results.innerHTML += '</ul>';
                
            } catch (error) {
                results.innerHTML += `<p>‚ùå Error: ${error.message}</p>`;
                console.error('Test error:', error);
            }
        }
        
        // Run the test when page loads
        document.addEventListener('DOMContentLoaded', testSeparatedMFMData);
    </script>
</body>
</html>
