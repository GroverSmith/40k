<!-- filename: units/unit-details.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Unit - 40k Crusade Campaign Tracker</title>
    <meta name="description" content="Edit an existing unit or character in your Crusade force.">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="../css/variables.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/buttons-unified.css">
    <link rel="stylesheet" href="../css/components-unified.css">
    <link rel="stylesheet" href="../css/responsive.css">
    <link rel="stylesheet" href="../css/forms-unified.css">
    <link rel="stylesheet" href="../css/modal.css">
    <link rel="stylesheet" href="../css/user-dropdown.css">
    <link rel="stylesheet" href="../css/user-field.css">
    
    <style>
        .unit-details-container {
            background: var(--color-background);
            border-radius: var(--border-radius);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }
        
        .unit-header {
            border-bottom: 2px solid var(--color-primary);
            padding-bottom: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }
        
        .unit-header h2 {
            margin: 0 0 var(--spacing-sm) 0;
            color: var(--color-primary);
        }
        
        .unit-meta {
            display: flex;
            gap: var(--spacing-md);
            flex-wrap: wrap;
        }
        
        .unit-type, .unit-points {
            background: var(--color-secondary);
            color: var(--color-background);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--border-radius-sm);
            font-size: var(--font-sm);
            font-weight: 500;
        }
        
        .unit-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }
        
        .detail-section {
            background: var(--color-surface);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
        }
        
        .detail-section h3 {
            margin: 0 0 var(--spacing-md) 0;
            color: var(--color-primary);
            border-bottom: 1px solid var(--color-border);
            padding-bottom: var(--spacing-xs);
        }
        
        .detail-item {
            display: flex;
            margin-bottom: var(--spacing-sm);
            align-items: flex-start;
        }
        
        .detail-item label {
            font-weight: 600;
            min-width: 120px;
            margin-right: var(--spacing-sm);
            color: var(--color-text-secondary);
        }
        
        .detail-item span {
            flex: 1;
            word-wrap: break-word;
        }
        
        .unit-actions {
            display: flex;
            gap: var(--spacing-md);
            justify-content: center;
            padding-top: var(--spacing-md);
            border-top: 1px solid var(--color-border);
        }
        
        .btn-danger {
            background-color: var(--color-error);
            color: white !important;
            border: none;
            padding: 12px 24px;
            border-radius: var(--radius-lg);
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
        }
        
        .btn-danger:hover:not(:disabled) {
            background-color: #d32f2f;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        @media (max-width: 768px) {
            .unit-details-grid {
                grid-template-columns: 1fr;
            }
            
            .detail-item {
                flex-direction: column;
            }
            
            .detail-item label {
                min-width: auto;
                margin-bottom: var(--spacing-xs);
            }
            
            .unit-actions {
                flex-direction: column;
            }
        }
        
        .loading-spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-button">‚Üê Back to Campaign Tracker</a>
        
        <header>
            <h1>Unit Details</h1>
            <p>View and edit unit or character details in your Crusade force roster.</p>
        </header>
        
        <main>
            <!-- Unit Information Display -->
            <div id="unit-info-display" class="unit-details-container">
                <div class="unit-header">
                    <h2 id="unit-display-name">Loading...</h2>
                    <div class="unit-meta">
                        <span id="unit-display-type" class="unit-type"></span>
                        <span id="unit-display-points" class="unit-points"></span>
                    </div>
                </div>
                
                <div class="unit-details-grid">
                    <div class="detail-section">
                        <h3>Basic Information</h3>
                        <div class="detail-item">
                            <label>Data Sheet:</label>
                            <span id="unit-display-data-sheet"></span>
                        </div>
                        <div class="detail-item">
                            <label>Unit Type:</label>
                            <span id="unit-display-unit-type"></span>
                        </div>
                        <div class="detail-item">
                            <label>MFM Version:</label>
                            <span id="unit-display-mfm-version"></span>
                        </div>
                        <div class="detail-item">
                            <label>Points:</label>
                            <span id="unit-display-points-value"></span>
                        </div>
                        <div class="detail-item">
                            <label>Crusade Points:</label>
                            <span id="unit-display-crusade-points"></span>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h3>Wargear & Upgrades</h3>
                        <div class="detail-item">
                            <label>Wargear:</label>
                            <span id="unit-display-wargear"></span>
                        </div>
                        <div class="detail-item">
                            <label>Enhancements:</label>
                            <span id="unit-display-enhancements"></span>
                        </div>
                        <div class="detail-item">
                            <label>Relics:</label>
                            <span id="unit-display-relics"></span>
                        </div>
                        <div class="detail-item">
                            <label>Battle Traits:</label>
                            <span id="unit-display-battle-traits"></span>
                        </div>
                        <div class="detail-item">
                            <label>Battle Scars:</label>
                            <span id="unit-display-battle-scars"></span>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h3>Battle Record</h3>
                        <div class="detail-item">
                            <label>Battle Count:</label>
                            <span id="unit-display-battle-count"></span>
                        </div>
                        <div class="detail-item">
                            <label>Experience Points:</label>
                            <span id="unit-display-xp"></span>
                        </div>
                        <div class="detail-item">
                            <label>Rank:</label>
                            <span id="unit-display-rank"></span>
                        </div>
                        <div class="detail-item">
                            <label>Kill Count:</label>
                            <span id="unit-display-kill-count"></span>
                        </div>
                        <div class="detail-item">
                            <label>Times Killed:</label>
                            <span id="unit-display-times-killed"></span>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h3>Narrative Information</h3>
                        <div class="detail-item">
                            <label>Description:</label>
                            <span id="unit-display-description"></span>
                        </div>
                        <div class="detail-item">
                            <label>Notable History:</label>
                            <span id="unit-display-notable-history"></span>
                        </div>
                        <div class="detail-item">
                            <label>Notes:</label>
                            <span id="unit-display-notes"></span>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h3>Metadata</h3>
                        <div class="detail-item">
                            <label>Created:</label>
                            <span id="unit-display-timestamp"></span>
                        </div>
                    </div>
                </div>
                
                <div class="unit-actions">
                    <button id="edit-unit-btn" class="btn-primary">Edit Unit</button>
                    <button id="delete-unit-btn" class="btn-danger">Delete Unit</button>
                </div>
            </div>
            
            
        </main>
    </div>

    <!-- JavaScript Files -->
    <script src="../js/core/utils.js"></script>
    <script src="../js/core/config.js"></script>
    <script src="../js/core/key-utils.js"></script>

    <!-- NEW consolidated utilities -->
    <script src="../js/core/form-utilities.js"></script>
    <script src="../js/core/ui-helpers.js"></script>

    <!-- UnifiedCache dependencies -->
    <script src="../js/table-defs.js"></script>
    <script src="../js/core/unified-cache-facade.js"></script>
    
    <!-- User modules -->
    <script src="../js/users/user-storage.js"></script>
    <script src="../js/users/user-api.js"></script>
    <script src="../js/users/user-ui.js"></script>
    <script src="../js/users/user-modal.js"></script>
    <script src="../js/users/user-manager.js"></script>

    <!-- Unit details script -->
    <script src="unit-details.js"></script>

    <!-- Embedded MFM Data -->
    <script>
        window.EMBEDDED_MFM_DATA = {
  "metadata": {
    "version": "3.2",
    "date": "AUG25",
    "totalUnits": 1228,
    "totalPoints": 185385,
    "forgeWorldUnits": 41,
    "factionCount": 27
  },
  "factions": {
    "ADEPTA SORORITAS": {
      "name": "Adepta Sororitas",
      "unitCount": 38,
      "totalPoints": 4080,
      "forgeWorldUnits": 0,
      "units": {
        "Aestred Thurga and Agathae Dolan": {
          "name": "Aestred Thurga and Agathae Dolan",
          "variants": [
            {
              "modelCount": 2,
              "points": 50
            }
          ]
        },
        "Arco-flagellants": {
          "name": "Arco-flagellants",
          "variants": [
            {
              "modelCount": 3,
              "points": 30
            },
            {
              "modelCount": 6,
              "points": 60
            }
          ]
        },
        "Battle Sisters Squad": {
          "name": "Battle Sisters Squad",
          "variants": [
            {
              "modelCount": 5,
              "points": 55
            },
            {
              "modelCount": 10,
              "points": 110
            }
          ]
        },
        "Canoness": {
          "name": "Canoness",
          "variants": [
            {
              "modelCount": 1,
              "points": 50
            }
          ]
        },
        "Celestian Sacresants": {
          "name": "Celestian Sacresants",
          "variants": [
            {
              "modelCount": 5,
              "points": 65
            },
            {
              "modelCount": 10,
              "points": 130
            }
          ]
        },
        "Celestian Squad": {
          "name": "Celestian Squad",
          "variants": [
            {
              "modelCount": 5,
              "points": 60
            },
            {
              "modelCount": 10,
              "points": 120
            }
          ]
        },
        "Crusaders": {
          "name": "Crusaders",
          "variants": [
            {
              "modelCount": 3,
              "points": 25
            },
            {
              "modelCount": 6,
              "points": 50
            }
          ]
        },
        "Death Cult Assassins": {
          "name": "Death Cult Assassins",
          "variants": [
            {
              "modelCount": 2,
              "points": 30
            },
            {
              "modelCount": 4,
              "points": 60
            }
          ]
        },
        "Dialogus": {
          "name": "Dialogus",
          "variants": [
            {
              "modelCount": 1,
              "points": 35
            }
          ]
        },
        "Dogmata": {
          "name": "Dogmata",
          "variants": [
            {
              "modelCount": 1,
              "points": 40
            }
          ]
        },
        "Dominion Squad": {
          "name": "Dominion Squad",
          "variants": [
            {
              "modelCount": 5,
              "points": 60
            },
            {
              "modelCount": 10,
              "points": 120
            }
          ]
        },
        "Exorcist": {
          "name": "Exorcist",
          "variants": [
            {
              "modelCount": 1,
              "points": 140
            }
          ]
        },
        "Hospitaller": {
          "name": "Hospitaller",
          "variants": [
            {
              "modelCount": 1,
              "points": 35
            }
          ]
        },
        "Imagifier": {
          "name": "Imagifier",
          "variants": [
            {
              "modelCount": 1,
              "points": 40
            }
          ]
        },
        "Immolator": {
          "name": "Immolator",
          "variants": [
            {
              "modelCount": 1,
              "points": 115
            }
          ]
        },
        "Junith Eruita": {
          "name": "Junith Eruita",
          "variants": [
            {
              "modelCount": 1,
              "points": 100
            }
          ]
        },
        "Missionary": {
          "name": "Missionary",
          "variants": [
            {
              "modelCount": 1,
              "points": 30
            }
          ]
        },
        "Mortifiers": {
          "name": "Mortifiers",
          "variants": [
            {
              "modelCount": 1,
              "points": 60
            },
            {
              "modelCount": 2,
              "points": 120
            }
          ]
        },
        "Novitiate Squad": {
          "name": "Novitiate Squad",
          "variants": [
            {
              "modelCount": 10,
              "points": 70
            }
          ]
        },
        "Palatine": {
          "name": "Palatine",
          "variants": [
            {
              "modelCount": 1,
              "points": 50
            }
          ]
        },
        "Paragon Warsuits": {
          "name": "Paragon Warsuits",
          "variants": [
            {
              "modelCount": 3,
              "points": 200
            }
          ]
        },
        "Penitent Engines": {
          "name": "Penitent Engines",
          "variants": [
            {
              "modelCount": 1,
              "points": 60
            },
            {
              "modelCount": 2,
              "points": 120
            }
          ]
        },
        "Preacher": {
          "name": "Preacher",
          "variants": [
            {
              "modelCount": 1,
              "points": 30
            }
          ]
        },
        "Repentia Squad": {
          "name": "Repentia Squad",
          "variants": [
            {
              "modelCount": 4,
              "points": 55
            },
            {
              "modelCount": 8,
              "points": 110
            }
          ]
        },
        "Retributor Squad": {
          "name": "Retributor Squad",
          "variants": [
            {
              "modelCount": 5,
              "points": 60
            },
            {
              "modelCount": 10,
              "points": 120
            }
          ]
        },
        "Rhino": {
          "name": "Rhino",
          "variants": [
            {
              "modelCount": 1,
              "points": 75
            }
          ]
        },
        "Saint Celestine": {
          "name": "Saint Celestine",
          "variants": [
            {
              "modelCount": 1,
              "points": 150
            }
          ]
        },
        "Seraphim Squad": {
          "name": "Seraphim Squad",
          "variants": [
            {
              "modelCount": 5,
              "points": 70
            },
            {
              "modelCount": 10,
              "points": 140
            }
          ]
        },
        "Sisters Novitiate": {
          "name": "Sisters Novitiate",
          "variants": [
            {
              "modelCount": 10,
              "points": 70
            }
          ]
        },
        "Sororitas Rhino": {
          "name": "Sororitas Rhino",
          "variants": [
            {
              "modelCount": 1,
              "points": 75
            }
          ]
        },
        "Triumph of Saint Katherine": {
          "name": "Triumph of Saint Katherine",
          "variants": [
            {
              "modelCount": 1,
              "points": 125
            }
          ]
        },
        "Zephyrim Squad": {
          "name": "Zephyrim Squad",
          "variants": [
            {
              "modelCount": 5,
              "points": 70
            },
            {
              "modelCount": 10,
              "points": 140
            }
          ]
        }
      }
    }
  }
};
    </script>
</body>
</html>
